<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>COVID-19 ‚Äì G√©n√©rateur d'attestation de d√©placement</title>

    <style>
        body {
            padding: 20px;
        }

        h4, form, footer {
            margin: 30px auto;
            max-width: 400px;
        }

        footer {
            margin-top: 40px;
        }

        canvas {
            border: 1px solid #ced4da;
            border-radius: .25rem;
        }

        #form-profile .form-check {
            margin-bottom: 1rem;
        }

        #form-profile .form-check-label {
            font-size: 80%;
            font-weight: 400;
            transform: translateY(-2px);
        }

        #form-generate .form-check {
            margin: 10px;
        }
    </style>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="shortcut icon" href="/icons/favicon.ico">
    <meta name="theme-color" content="#ffffff">
    <link rel="manifest" href="/pwa.webmanifest">
</head>
<body>
    <div class="alert alert-danger" role="alert" style="display: none" id="alert-facebook">
        ATTENTION !! Vous utilisez actuellement le navigateur Facebook, ce g√©n√©rateur ne fonctionne pas correctement au
        sein de ce navigateur ! Merci d'ouvrir Chrome sur Android ou bien Safari sur iOS.
    </div>

    <h4>COVID-19 ‚Äì G√©n√©rateur d'attestation de d√©placement</h4>

    <form id="form-profile" style="display: none">
        <div class="alert alert-primary" role="alert">
            <small>
                Ce g√©n√©rateur est l√† pour faciliter l'usage des attestations. Cr√©ez un profil <small>(stock√© sur votre
                appareil)</small>, vous n'aurez alors plus qu'√† choisir le motif pour chacune de vos sorties. Nul besoin
                d'imprimer, <a href="https://twitter.com/Numerama/status/1239854535465676800">les attestations
                num√©riques sont autoris√©es.</a>
                <br><br>
                <a href="https://www.interieur.gouv.fr/Actualites/L-actu-du-Ministere/Attestation-de-deplacement-derogatoire-et-justificatif-de-deplacement-professionnel">
                    Plus d'informations sur le site officiel du gouvernement.
                </a>
            </small>
        </div>

        <h5>Remplissez votre profil</h5>

        <div class="form-group">
            <label for="field-name">Nom et pr√©nom</label>
            <input type="text" class="form-control" id="field-name" name="name" autofocus>
        </div>

        <div class="form-group">
            <label for="field-birthday">Date de naissance</label>
            <input type="text" class="form-control" id="field-birthday" name="birthday">
        </div>

        <div class="form-group">
            <label for="field-address">Adresse</label>
            <input type="text" class="form-control" id="field-address" name="address">
        </div>

        <div class="form-group">
            <label for="field-town">Ville</label>
            <input type="text" class="form-control" id="field-town" name="town">
        </div>

        <div class="form-group">
            <label for="field-zipcode">Code Postal</label>
            <input type="text" class="form-control" id="field-zipcode" name="zipcode">
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" id="check-same-town" checked>
            <label class="form-check-label" for="check-same-town">Je r√©side actuellement √† cette adresse</label>
        </div>

        <div class="form-group" id="group-done-at" style="display: none">
            <label for="field-done-at">Fait √†</label>
            <input type="text" class="form-control" id="field-done-at" name="done-at" disabled>
        </div>

        <div class="form-group">
            <label>Signature</label>
            <small id="help-signature" class="form-text text-muted">Dessinez votre signature dans la case ci-dessous.</small>
            <canvas id="field-signature" width=360 height=240 aria-describedby="help-signature"></canvas>
            <button id="reset-signature" type="button" class="btn btn-link btn-sm float-right">Effacer la signature</button>
            <br><br>
        </div>

        <button type="submit" class="btn btn-primary">Enregistrer mon profil</button>
    </form>

    <form id="form-generate" style="display: none">
        <div class="alert alert-warning" role="alert">
            <small>
                Si vous n'avez pas besoin de sortir, <u>restez chez vous</u> ! Ce g√©n√©rateur est l√† pour faciliter les
                sorties fr√©quentes <u>justifi√©es</u>. Veillez √† prendre soin de vous et des autres en limitant la
                propagation du virus. ü¶† üò∑
            </small>
        </div>

        <h5>Choisissez un motif de sortie</h5>

        <div class="form-check">
            <input class="form-check-input" type="radio" name="field-reason" id="radio-work" value="work" checked>
            <label class="form-check-label" for="radio-work">Travail</label>
        </div>

        <div class="form-check">
            <input class="form-check-input" type="radio" name="field-reason" id="radio-groceries" value="groceries">
            <label class="form-check-label" for="radio-groceries">Courses</label>
        </div>

        <div class="form-check">
            <input class="form-check-input" type="radio" name="field-reason" id="radio-health" value="health">
            <label class="form-check-label" for="radio-health">Sant√©</label>
        </div>

        <div class="form-check">
            <input class="form-check-input" type="radio" name="field-reason" id="radio-family" value="family">
            <label class="form-check-label" for="radio-family">Famille</label>
        </div>

        <div class="form-check">
            <input class="form-check-input" type="radio" name="field-reason" id="radio-sport" value="sport">
            <label class="form-check-label" for="radio-sport">Sport &amp; animaux</label>
        </div>

        <br><br>
        <button type="submit" class="btn btn-primary">G√©n√©rer mon attestation</button>

        <br><br>
        <button type="button" class="btn btn-link btn-sm" onclick="localStorage.clear(); location.reload()">
            Effacer mon profil
        </button>
    </form>

    <footer class="footer text-center">
        <small>
            <a href="https://github.com/nesk/covid-19-certificate">Github</a>
            -
            <a href="https://nesk.dev">nesk.dev</a>
            -
            <a href="https://twitter.com/johannpardanaud">@johannpardanaud</a>
        </small>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.4.1/dist/pdf-lib.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js"></script>
    <script src="certificate.js"></script>
    <script>
      // Progressive Web App - Autorise √† installer l'application sur mobile
      // Check compatibility for the browser we're running this in
      if ("serviceWorker" in navigator) {
        if (navigator.serviceWorker.controller) {
          console.log("[PWA Builder] active service worker found, no need to register");
        } else {
          // Register the service worker
          navigator.serviceWorker
            .register("sw.js", {
              scope: "./"
            })
            .then(function (reg) {
              console.log("[PWA Builder] Service worker has been registered for scope: " + reg.scope);
            });
        }
      }
    </script>
</body>
</html>
